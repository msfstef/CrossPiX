(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(t,e,a){t.exports=a(25)},,,,,,function(t,e,a){},,function(t,e,a){},,function(t,e,a){},,function(t,e,a){},,function(t,e,a){},,function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(7),o=a.n(i),l=(a(15),a(1)),c=a(2),h=a(4),s=a(3),d=a(5),u=function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(s.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"onImgLoad",value:function(){var t=this,e=new Image;e.src=this.props.fileUrl;var a=document.getElementById("PreEditorCanvas"),n=a.getContext("2d");e.onload=function(){var r=e.height/e.width;r<1?(a.width=300,a.height=a.width*r):(a.height=300,a.width=a.height/r),n.clearRect(0,0,a.width,a.height);var i=a.width,o=a.height;n.drawImage(e,0,0,i,o);for(var l=n.getImageData(0,0,a.width,a.height),c=0;c<l.data.length;c+=4)0===l.data[c+3]?(l.data[c]=255,l.data[c+1]=255,l.data[c+2]=255,l.data[c+3]=255):l.data[c+3]=255;n.putImageData(l,0,0),t.props.outputHandler({preEditUrl:a.toDataURL(),width:a.width,proportion:r})}}},{key:"componentDidUpdate",value:function(t){this.props.fileUrl!==t.fileUrl&&this.onImgLoad()}},{key:"render",value:function(){return r.a.createElement("div",{className:"picEditor"},r.a.createElement("canvas",{className:"picCanvas",id:"PreEditorCanvas"}))}}]),e}(n.Component),m=(a(17),function(t){function e(){var t,a;Object(l.a)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(h.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(r)))).state={value:a.props.defaultValue},a}return Object(d.a)(e,t),Object(c.a)(e,[{key:"componentDidUpdate",value:function(){var t=document.getElementById(this.props.name).value;t!==this.state.value&&this.setState({value:t})}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"Slider"},r.a.createElement("input",{id:this.props.name,type:"range",step:"1",min:this.props.min,max:this.props.max,defaultValue:this.props.defaultValue,onChange:function(){t.props.handler(),t.setState({value:document.getElementById(t.props.name).value})}}),r.a.createElement("span",{className:"SliderValue"},r.a.createElement("span",{className:"SliderText"},this.state.value)))}}]),e}(n.Component)),p=function(t,e){e?(t.imageSmoothingEnabled=!0,t.mozImageSmoothingEnabled=!0,t.webkitImageSmoothingEnabled=!0,t.msImageSmoothingEnabled=!0):(t.imageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.msImageSmoothingEnabled=!1)},g=function(t){function e(){var t,a;Object(l.a)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(h.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(r)))).state={defaultHorStitches:75,horStitches:75},a.handleSlider=function(){a.setState({horStitches:document.getElementById("horStitchesSlider").value}),a.onImgLoad()},a}return Object(d.a)(e,t),Object(c.a)(e,[{key:"onImgLoad",value:function(){var t=this,e=new Image;e.src=this.props.fileUrl;var a=document.getElementById("PixelatorCanvas");e.onload=function(){var n=e.width,r=e.height;a.width=e.width,a.height=e.height;var i=a.getContext("2d");i.clearRect(0,0,a.width,a.height);var o=t.state.horStitches,l=e.height/e.width*t.state.horStitches;a.width=o,a.height=l,p(i,!0),i.drawImage(e,0,0,o,l),t.props.outputHandler({pixelUrl:a.toDataURL()}),a.width=n,a.height=r,p(i,!0),i.drawImage(e,0,0,o,l),p(i,!1),i.drawImage(a,0,0,o,l,0,0,a.width,a.height)}}},{key:"componentDidUpdate",value:function(t){this.props.fileUrl!==t.fileUrl&&(document.getElementById("horStitchesSlider").value=this.state.defaultHorStitches,this.setState({horStitches:this.state.defaultHorStitches}),this.onImgLoad())}},{key:"render",value:function(){return r.a.createElement("div",{className:"picEditor"},r.a.createElement("canvas",{className:"picCanvas",id:"PixelatorCanvas"}),r.a.createElement(m,{name:"horStitchesSlider",min:"10",max:"150",handler:this.handleSlider,defaultValue:this.state.defaultHorStitches}))}}]),e}(n.Component),f=a(8),v=a.n(f),b=function(t,e){if(t.length!==e.length)return!1;for(var a=0;a<t.length;++a)if(t[a]!==e[a])return!1;return!0},w=function(t,e){void 0===e&&(e=-1);var a=document.createElement("canvas"),n=t.width*t.height,r=t.width,i=t.height;if(e>0&&n>e){var o=function(t,e,a){var n=t/e,r=Math.sqrt(a/n);return[Math.floor(n*r),Math.floor(r)]}(t.width,t.height,e);r=o[0],i=o[1]}a.width=r,a.height=i;var l=r*i,c=a.getContext("2d");c.drawImage(t,0,0,r,i);for(var h=c.getImageData(0,0,r,i).data,s=h.length/l,d=[],u=0;u<h.length;u+=s)d.push(h.slice(u,u+s));return d},E=function(t,e){for(var a=1/0,n=-1,r=0;r<e.length;++r){for(var i=e[r],o=0,l=0;l<t.length;++l)o+=Math.pow(t[l]-i[l],2);o<a&&(a=o,n=r)}return n},y=function(t){if(0===t.length)return[];for(var e=[],a=0;a<t[0].length;++a)e.push(0);for(var n=0;n<t.length;++n)for(var r=t[n],i=0;i<r.length;++i)e[i]+=(r[i]-e[i])/(n+1);return e},I=function(t,e){return function(t,e){var a=t.width,n=t.height,r=document.createElement("canvas");r.width=a,r.height=n;var i=r.getContext("2d");i.drawImage(t,0,0,a,n);for(var o=i.getImageData(0,0,a,n).data,l=a*n,c=o.length/l,h=new Uint8ClampedArray(o.length),s=new Uint8ClampedArray(c),d=0;d<o.length;d+=c){for(var u=0;u<c;++u)s[u]=o[d+u];for(var m=e[E(s,e)],p=0;p<m.length;++p)h[d+p]=m[p]}var g=document.createElement("canvas");g.width=a,g.height=n;var f=g.getContext("2d"),v=f.createImageData(a,n);return v.data.set(h),f.putImageData(v,0,0),g.toDataURL()}(t,function(t,e){void 0===e&&(e=Math.min(3,t.length));for(var a=0,n=function(){return(a=(9301*a+49297)%233280)/233280},r=[],i=0;i<e;++i){var o=Math.floor(n()*t.length);r.push(t[o])}for(;;){for(var l=[],c=0;c<e;++c)l.push([]);for(var h=0;h<t.length;++h){var s=t[h];l[E(s,r)].push(s)}for(var d=!0,u=0;u<e;++u){var m=l[u],p=[];p=m.length>0?y(m):t[Math.floor(n()*t.length)],d=d&&b(p,r[u]),r[u]=p}if(d)break}return r}(w(t,5e4),e))},S=(a(19),function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(s.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var t=this.props.palette,e=[],a=[];for(var n in t)e.push([n,t[n][0],t[n][1],t[n][2]]);e.sort(function(t,e){return e[3]-t[3]});for(var i=0;i<e.length;i++){var o={backgroundColor:"#"+e[i][2],height:"20px",width:"40px"};a.push(r.a.createElement("div",{key:e[i],className:"paletteColor"},r.a.createElement("div",{style:o,className:"paletteBox"}),r.a.createElement("p",null,e[i][1]),r.a.createElement("p",null,"DMC: "+e[i][0]),r.a.createElement("p",null,"Count: "+e[i][3])))}return r.a.createElement("div",{className:"Palette"},a)}}]),e}(n.Component)),C=function(t){function e(){var t,a;Object(l.a)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(h.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(r)))).state={colors:10,rgb_dmc:[],rgb_dmc_pure:[],defaultColors:10,palette:{}},a.handleSlider=function(){a.setState({colors:document.getElementById("colorSlider").value}),a.onImgLoad()},a}return Object(d.a)(e,t),Object(c.a)(e,[{key:"onImgLoad",value:function(){var t=this,e=new Image,a=new Image;e.src=this.props.fileUrl;var n=document.getElementById("ColorMapperCanvas"),r=n.getContext("2d");e.onload=function(){var n=I(e,t.state.colors);a.src=n},a.onload=function(){n.width=t.props.initWidth,n.height=n.width*t.props.proportion,r.drawImage(a,0,0);for(var e=r.getImageData(0,0,a.width,a.height),i=new Array(e.data.length),o={},l=0;l<e.data.length;l+=4){for(var c=e.data[l+0],h=e.data[l+1],s=e.data[l+2],d=99999999,u=0,m=0;m<t.state.rgb_dmc.length;m+=1){var g=t.state.rgb_dmc[m][2],f=t.state.rgb_dmc[m][3],v=t.state.rgb_dmc[m][4],b=(c-g)*(c-g)+(h-f)*(h-f)+(s-v)*(s-v);if(b<d&&(d=b,u=m,b<2))break}i[l+0]=t.state.rgb_dmc[u][2],i[l+1]=t.state.rgb_dmc[u][3],i[l+2]=t.state.rgb_dmc[u][4],i[l+3]=255,t.state.rgb_dmc[u][0]in o?o[t.state.rgb_dmc[u][0]][2]++:o[t.state.rgb_dmc[u][0]]=[t.state.rgb_dmc[u][1],t.state.rgb_dmc[u][5],1]}t.setState({palette:o}),e.data.set(i),r.putImageData(e,0,0),p(r,!1),r.drawImage(n,0,0,a.width,a.height,0,0,n.width,n.height)}}},{key:"componentDidMount",value:function(){var t=this;v.a.parse("/assets/rgb_to_dmc.csv",{download:!0,complete:function(e){t.setState({rgb_dmc:e.data.slice(1)});var a=t.state.rgb_dmc.map(function(t){return t.slice(2,5)});t.setState({rgb_dmc_pure:a})}})}},{key:"componentDidUpdate",value:function(t){this.props.fileUrl!==t.fileUrl&&(document.getElementById("colorSlider").value=this.state.defaultColors,this.setState({colors:this.state.defaultColors}),this.onImgLoad())}},{key:"render",value:function(){return r.a.createElement("div",{className:"picEditor"},r.a.createElement("canvas",{className:"picCanvas",id:"ColorMapperCanvas"}),r.a.createElement(S,{palette:this.state.palette}),r.a.createElement(m,{name:"colorSlider",min:"2",max:"50",handler:this.handleSlider,defaultValue:this.state.defaultColors}))}}]),e}(n.Component),j=(a(21),function(t){function e(){var t,a;Object(l.a)(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(h.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(r)))).state={width:0,proportion:0,fileUrl:"",preEditUrl:"",pixelUrl:""},a.handleFile=function(t){var e=document.getElementById("img_upload").files[0];e&&a.setState({fileUrl:window.URL.createObjectURL(e)})},a.outputHandler=function(t){a.setState(t)},a}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this;return r.a.createElement("div",{id:"AppContainer"},r.a.createElement("input",{type:"file",id:"img_upload",accept:"image/*",onChange:function(){t.handleFile()}}),r.a.createElement(u,{fileUrl:this.state.fileUrl,outputHandler:this.outputHandler}),r.a.createElement(g,{fileUrl:this.state.preEditUrl,outputHandler:this.outputHandler}),r.a.createElement(C,{fileUrl:this.state.pixelUrl,outputHandler:this.outputHandler,initWidth:this.state.width,proportion:this.state.proportion}))}}]),e}(n.Component)),O=(a(23),function(t){function e(){return Object(l.a)(this,e),Object(h.a)(this,Object(s.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(j,null))}}]),e}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}],[[9,2,1]]]);
//# sourceMappingURL=main.a6e4f814.chunk.js.map